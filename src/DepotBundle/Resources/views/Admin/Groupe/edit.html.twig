{% extends "admin.html.twig" %}

{% block stylesheets %}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/dt-1.10.16/datatables.min.css"/>
{% endblock %}

{% block javascripts %}
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/v/dt/dt-1.10.16/datatables.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <script>
        
        $("#etud_dispo").DataTable({
            "language": {
                "lengthMenu": "Affichage _MENU_ enregistrements par page",
                "zeroRecords": "Aucune données",
                "info": "Affichage de la page _PAGE_ sur _PAGES_",
                "infoEmpty": "Aucune données",
                "infoFiltered": "(filtré sur _MAX_ enregistrements)",
                "search":         "Rechercher :",
                "paginate": {
                    "first":      "Premier",
                    "last":       "Dernier",
                    "next":       "Suivant",
                    "previous":   "Précédent"
                },
            }
        });
        $("#etud_in_grp").DataTable({
            "language": {
                "lengthMenu": "Affichage _MENU_ enregistrements par page",
                "zeroRecords": "Aucune données",
                "info": "Affichage de la page _PAGE_ sur _PAGES_",
                "infoEmpty": "Aucune données",
                "infoFiltered": "(filtré sur _MAX_ enregistrements)",
                "search":         "Rechercher :",
                "paginate": {
                    "first":      "Premier",
                    "last":       "Dernier",
                    "next":       "Suivant",
                    "previous":   "Précédent"
                },
            }
        });
        
        {% for message in app.flashes('error') %}
            toastr.error("{{ message }}", "Une erreur s'est produite");
        {% endfor %}
    </script>
{% endblock %}


{% block main %}
    <div class="container">
        <div class="row">
            <div class="col-xs-12">
                <h1>Édition d'un groupe</h1>
            </div>
        </div>

        <div class="row">
            <div class="col-xs-12">
                <div class="item">
                    {{ form_start(edit_form) }}
                        {{ form_widget(edit_form) }}
                    <button type="submit" class="btn btn-default">Sauvegarder</button>
                    {{ form_end(edit_form) }}
                </div>
                <div class="item">
                    <h2>Liste des étudiants disponibles</h2>
                    <table style="margin-bottom: 15px" id="etud_dispo">
                        <thead>
                            <tr>
                                <th>Pseudo</th>
                                <th>Nom</th>
                                <th>Prénom</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for user in users %}
                                <tr>
                                    <td>{{ user.username }}</td>
                                    <td>{{ user.firstName }}</td>
                                    <td>{{ user.lastName }}</td>
                                    <td>
                                        <a href="{{ path("add_user_to_groupe", {user:user.id, groupe:groupe.id}) }}">Ajouter au groupe</a>
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                <div class="item">
                    <h2>Liste des étudiants présents dans le groupe</h2>
                    <table style="margin-bottom: 15px" id="etud_in_grp">
                        <thead>
                            <tr>
                                <th>Pseudo</th>
                                <th>Nom</th>
                                <th>Prénom</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for user in users_in_groupe %}
                                <tr>
                                    <td>{{ user.username }}</td>
                                    <td>{{ user.firstName }}</td>
                                    <td>{{ user.lastName }}</td>
                                    <td>
                                        <a href="{{ path("remove_user_to_groupe", {user:user.id, groupe:groupe.id}) }}">Retirer du groupe</a>
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
{% endblock %}